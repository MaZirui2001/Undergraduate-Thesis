# 辅修毕业答辩

​	尊敬的各位管理学院评委老师：

​	大家上午好！

​	我是辅修金融学的本科生马子睿，来自计算机学院，今天我为大家带来题目为《基于深度学习的股票价格水平预测》的论文答辩

​	首先，请允许我介绍一下论文的基本情况。本论文由我个人独立完成，我的教师为我校管理学院副教授李勇老师。

​	本次答辩我将从以下三个方面展开。

​	首先，我将介绍一下本文的研究背景。

​	股票预测是当前金融领域较为热点的话题。从上个世纪开始，各路学者就开始尝试使用基本面技术分析和统计计量方法对股票价格水平进行预测，但由于股票市场的快速变化和复杂性，这些方法都只能在很局限的时间跨度内做出预测，其普适性和通用性都得不到保障。而在当今，股票预测主要依仗于深度学习方法，这主要是因为深度学习通过多层神经网络对数据进行模式识别，能够较好的保证其准确性和稳定性。

​	本文主要基于LSTM网络对股票进行预测。LSTM在设计之时就主要面向数据的长期依赖性，而股票市场的变动在一定程度上也有长期依赖性，LSTM可以对其进行更好的捕捉。除此之外，LSTM独特的门控机制可以有效过滤噪声，这对于局部具有高度波动性的股票市场是十分有效的。最后，股票市场的价格的影响因素较多，而LSTM正是善于将多个复杂特征之间的复杂关系纳入预测模型，从而实现更好的拟合。

​	虽然通过深度学习预测股票价格具有许多优点，但我在实验过程中发现，其预测结果对初始超参数的选取依赖度较大。对于股票价格预测而言，一组好的超参数不仅能够提升整体模型的性能，使其捕捉到更复杂的关系，还可以解决股票预测中非常常见的过拟合和欠拟合的问题。除此之外，模型训练的时间和资源使用也是影响模型验证速度的重要因素，而好的超参数也可以解决这一类问题。本文将重点聚焦于针对股票预测的超参数自动调整算法。

​	接下来我来介绍本文的研究流程。首先，我使用LSTM对中国平安A股的数据进行学习，随后将2016年提出的鲸鱼超参数优化算法经过适配后，加入训练过程，最后我将混沌理论、自适应权重等动态调整算法融合入鲸鱼算法，根据股票市场的特点进行适当改动，并对这三种训练模型的训练结果进行对比，从而验证优化算法的有效性。

​	接下来我将介绍本文的主要研究工作。

​	在数据集选取方面，我选取了中国平安A股2016年~2020年的全部数据，每一项数据都包括了多个指标信息。获取数据后，我分别使用删除无效值法和Min-Max标准化法对数据进行清洗和标准化，再按照7:3的比例对其进行分割

​	随后我搭建了较为完善的LSTM网络，其基本配置如左侧所示。经过我的大量实验发现，股票预测在前期和后期对学习率的要求并不相同，特别是后期，如果学习率保持不变，则其损失会有大幅度波动，因此，我采用了指数衰减法对模型进行调度。

​	我使用了每99天的数据对第100天进行预测，预测的损失曲线和测试集上的拟合程度如右图所示。虽然LSTM已经能够对股票价格趋势做出预测，但从预测曲线的右上角处可以看出，对于一些股票市场的极端值，预测往往无法十分精准，且之前展示的超参数选取过于依赖经验，我们需要一些方法对其进行改进。

​	因此，我们将用于超参数优化的鲸鱼算法引入股票预测的超参数调整。鲸鱼算法是一类应用于组合优化问题的启发式算法，其灵感来源于座头鲸捕食的三种包围猎物的行为：气泡网螺旋更新、收网逼近和随机搜索。在深度学习中，我们可以将所有超参数的一种组合视为一条高维鲸鱼，通过实例化多条这样的鲸鱼，我们就可以模拟鲸鱼捕食的行为，启发式地逼近超参数最优解。而之所以选取鲸鱼算法作为股票预测的超参数优化算法，主要是由于股票市场的价格往往存在局部最优解，这会给梯度下降的深度学习造成局部最优解陷阱，而鲸鱼算法具有全局优化能力强、适应性强的特点，可以在一定程度上解决这个问题。

​	我们将以下四个超参数组合为一条四维鲸鱼，在LSTM正式训练前，随机生成8条这样的鲸鱼，并根据鲸鱼算法的更新策略进行逼近。当算法结束后，我们将算法输出的超参数组合作为LSTM的超参数，并基于此进行进一步学习拟合。

​	这里展示了经过鲸鱼算法优化后的预测结果与损失，可以看出，不管是从损失率还是从预测效果来看，鲸鱼算法针对我们刚才提到的极端值预测问题有了较好的解决，这可以证明鲸鱼算法对于基于深度学习的股票预测效果有一定作用。

​	至此，我们的预测工作总体而言差强人意，接下来我将介绍我针对鲸鱼算法的进一步探索优化。首先，在实验过程中，我发现鲸鱼算法的初始种群位置对结果存在较大影响。传统的鲸鱼算法使用随机数生成若干个高维鲸鱼，这容易导致鲸鱼初始种群扎堆，不能很好地搜索到最优解。因此，我引入了Tent混沌生成序列，并从初始种群和反向种群中选取最优的若干个，作为鲸鱼算法的初始种群，使其分布更加均匀。

​	其次，在螺旋移动和收网逼近时，其变化率是线性或不变的，这不能很好地模拟座头鲸捕食时捕食轨迹逐步缩小的变化，因此我对递减收敛因子和螺旋形状因子都进行了非线性处理，使其能够在训练后期逐步放缓逼近最优解的速度，避免陷入局部最优解。

​	随后，考虑到每次鲸鱼更新自身位置都需要依赖于最优解和自身的当前位置，训练后期可能会过于“相信”最优解，因此我们改进了更新公式，使用如图的一个自适应权重函数，使得后期最优解的话语权逐步降低，从而让个体更能在自身附近探索最优解。

​	最后，为了从当前最优解的角度尽可能避免其陷入局部最优解，我们结合股票市场的特点可以做出如下改进：每隔几次迭代，我都会让最优解以自身为中心进行环形抖动，以探索其附近是否还存在更优的情况。这种方法对应解决了股票市场中局部高峰后的又一价格高峰的情况。

​	这里展示出了改良后的鲸鱼算法的预测效果改进。从预测效果图上我们可以看出，在极端值预测方面，改良后的鲸鱼算法体现了较好的预测效果，在损失率方面也相较之前的版本有了提升。

​	最后我将对总结本文研究结果并展望未来的发展。

​	本文主要提出将鲸鱼优化算法应用于LSTM对中国A股的预测中，使用自动算法对LSTM的超参数进行针对性调整，使其能够更好地适应股票预测工作。随后，我们在鲸鱼算法的基础上，引入混沌序列、自适应权重等人工智能算法策略，让LSTM的超参数调整在股票预测上有了更好的表现。

​	在未来，我将进一步对LSTM的超参数自动调整算法进行优化，并在允许的条件下，将这种优化思路尝试应用于更多深度学习框架，并进一步提升LSTM框架的模型性能，使其能够更好的预测股票。

​	我的答辩到此结束，感谢各位老师的聆听，请各位老师批评指正，谢谢！

​	